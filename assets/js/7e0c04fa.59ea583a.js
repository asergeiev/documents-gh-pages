"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4914],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return p}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),s=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),m=s(n),p=r,f=m["".concat(l,".").concat(p)]||m[p]||d[p]||o;return n?a.createElement(f,i(i({ref:t},u),{},{components:n})):a.createElement(f,i({ref:t},u))}));function p(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5360:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return u},default:function(){return m}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],c={id:"face-data-migration",title:"Face Data Migration",sidebar_label:"Face Data Migration"},l="Face data migration",s={unversionedId:"face-data-migration",id:"face-data-migration",isDocsHomePage:!1,title:"Face Data Migration",description:"When do you need to migrate data",source:"@site/docs/Face-data-migration.md",sourceDirName:".",slug:"/face-data-migration",permalink:"/documents/docs/face-data-migration",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/Face-data-migration.md",tags:[],version:"current",frontMatter:{id:"face-data-migration",title:"Face Data Migration",sidebar_label:"Face Data Migration"},sidebar:"someSidebar",previous:{title:"Custom Builds",permalink:"/documents/docs/custom-builds"},next:{title:"User Roles System",permalink:"/documents/docs/user-roles-system"}},u=[{value:"When do you need to migrate data",id:"when-do-you-need-to-migrate-data",children:[],level:2},{value:"Limitations",id:"limitations",children:[],level:2},{value:"How to perform a migration",id:"how-to-perform-a-migration",children:[],level:2}],d={toc:u};function m(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"face-data-migration"},"Face data migration"),(0,o.kt)("h2",{id:"when-do-you-need-to-migrate-data"},"When do you need to migrate data"),(0,o.kt)("p",null,"When you upload a new known image to the Face Collection, CompreFace\nuses a neural network model to calculate an embedding (also known as\nface features), which is an array of 512 or 128 numbers. Then CompreFace\nsaves it to the database to use in the future comparison - when you\nupload a face to recognize, CompreFace again calculates an embedding and\ncompares it to saved embeddings."),(0,o.kt)("p",null,"The important thing here is that every neural network model calculates\ndifferent embeddings. Therefore, it means that it makes sense to compare\nembeddings calculated by the same neural network model."),(0,o.kt)("p",null,"CompreFace doesn't change the neural network model during its work, so\nyou usually don't need to migrate your face data. If you want to try\n",(0,o.kt)("a",{parentName:"p",href:"/documents/docs/custom-builds"},"custom build"),", be very careful - look at the table\n","[here]",", column ",(0,o.kt)("inlineCode",{parentName:"p"},"Face recognition model")," - if\nthe model changed, you need to run a migration."),(0,o.kt)("h2",{id:"limitations"},"Limitations"),(0,o.kt)("p",null,"If you run CompreFace in the ",(0,o.kt)("a",{parentName:"p",href:"/documents/docs/configuration"},'"not saving images to database"\nmode'),"(",(0,o.kt)("inlineCode",{parentName:"p"},"save_images_to_db=false"),"), you won't be\nable to migrate data as the original images are required for migration."),(0,o.kt)("p",null,"The only solution here is to delete all images from Face Collection and\nupload them again."),(0,o.kt)("h2",{id:"how-to-perform-a-migration"},"How to perform a migration"),(0,o.kt)("p",null,"Current migration was written for internal usage and wasn't tested\nenough, so please do a backup copy of the database and perform migration\nat your own risk."),(0,o.kt)("p",null,"REST request to start migration:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"curl -i -X POST \\\n'http://localhost:8000/api/v1/migrate'\n")),(0,o.kt)("p",null,'This rest endpoint is asynchronous; it starts the migration and returns\na response immediately. Please look at logs for "Migration successfully\nfinished" text to understand if the migration is successful.'))}m.isMDXComponent=!0}}]);